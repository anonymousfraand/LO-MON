{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\kingswin\\\\Downloads\\\\learning-management-system-project-master\\\\learning-management-system-project-master\\\\lms-react-redux\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\kingswin\\\\Downloads\\\\learning-management-system-project-master\\\\learning-management-system-project-master\\\\lms-react-redux\\\\src\\\\CourseCard.js\";\nimport React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { Confirm } from 'semantic-ui-react';\n\nfunction CourseCard(props) {\n  // console.log(props.course.id)\n  const token = localStorage.getItem(\"token\");\n\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        open = _useState2[0],\n        setOpen = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        openStudent = _useState4[0],\n        setOpenStudent = _useState4[1];\n\n  function show() {\n    setOpen(true);\n  }\n\n  function handleConfirm(id) {\n    handleOnClick();\n    setOpen(false);\n  }\n\n  function handleCancel() {\n    setOpen(false);\n  }\n\n  function studentShow() {\n    setOpenStudent(true);\n  }\n\n  function studentHandleConfirm(id) {\n    handleStudentClick();\n    setOpenStudent(false);\n  }\n\n  function studentHandleCancel() {\n    setOpenStudent(false);\n  }\n\n  function handleOnClick() {\n    // console.log(props.course.id)\n    fetch(\"https://lms-api-rails.herokuapp.com/api/v1/teachers/\".concat(props.currentUser.id, \"/courses/\").concat(props.course.id), {\n      method: \"DELETE\",\n      headers: {\n        \"Authorization\": \"Bearer \".concat(token)\n      }\n    }).then(resp => resp.json()).then(data => {\n      // console.log(data) //returns json message of delete success\n      props.removeCourse(props.course.id);\n      props.removeCourseFromAllCourse(props.course.id);\n    });\n  }\n\n  function handleStudentClick() {\n    const token = localStorage.getItem(\"token\"); // console.log(props.course)\n    // console.log(props.currentUser)\n\n    let currentEnrollment;\n    fetch(\"https://lms-api-rails.herokuapp.com/api/v1/students/\".concat(props.currentUser.id, \"/enrollments\"), {\n      headers: {\n        \"Authorization\": \"Bearer \".concat(token)\n      }\n    }).then(resp => resp.json()).then(data => {\n      // console.log(data)\n      data.map(enrollment => {\n        // debugger\n        if (enrollment.course.id === props.course.id && enrollment.student.id === props.currentUser.id) {\n          currentEnrollment = enrollment; // debugger\n        }\n      });\n      removeClickedCourse(currentEnrollment.id);\n    }); // console.log(currentEnrollment)\n  }\n\n  function removeClickedCourse(id) {\n    const token = localStorage.getItem(\"token\");\n    fetch(\"https://lms-api-rails.herokuapp.com/api/v1/students/\".concat(props.currentUser.id, \"/enrollments/\").concat(id), {\n      method: \"DELETE\",\n      headers: {\n        \"Authorization\": \"Bearer \".concat(token)\n      }\n    }).then(resp => resp.json()).then(data => {\n      // console.log(data) //returns json message of delete success\n      props.removeCourse(props.course.id);\n    });\n  }\n\n  return React.createElement(\"div\", {\n    className: \"column\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ui segment course\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, props.course.subject.name), React.createElement(Link, {\n    to: {\n      pathname: \"/courses/\".concat(props.course.id),\n      courseProps: props.course\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, props.course.name)), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }), props.currentUser.position === 'teacher' ? React.createElement(\"span\", {\n    \"data-tooltip\": \"Delete Course\",\n    \"data-position\": \"bottom left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    onClick: () => show(),\n    className: \"big red trash icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }), React.createElement(Confirm, {\n    open: open,\n    header: \"Removing this Course.\",\n    onCancel: () => handleCancel(),\n    onConfirm: () => handleConfirm(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  })) : React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    onClick: () => studentShow(),\n    className: \"ui red button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, \"Drop Course\"), React.createElement(Confirm, {\n    open: openStudent,\n    header: \"Removing this Course.\",\n    onCancel: () => studentHandleCancel(),\n    onConfirm: () => studentHandleConfirm(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }))));\n}\n\nfunction mapStateToProps(state) {\n  return {\n    currentUser: state.currentUser\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    removeCourse: id => {\n      dispatch({\n        type: \"REMOVE_COURSE\",\n        payload: id\n      });\n    },\n    removeCourseFromAllCourse: id => {\n      dispatch({\n        type: \"REMOVE_COURSE_FROM_ALL_COURSES\",\n        payload: id\n      });\n    }\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CourseCard);","map":{"version":3,"sources":["C:\\Users\\kingswin\\Downloads\\learning-management-system-project-master\\learning-management-system-project-master\\lms-react-redux\\src\\CourseCard.js"],"names":["React","useState","Link","connect","Confirm","CourseCard","props","token","localStorage","getItem","open","setOpen","openStudent","setOpenStudent","show","handleConfirm","id","handleOnClick","handleCancel","studentShow","studentHandleConfirm","handleStudentClick","studentHandleCancel","fetch","currentUser","course","method","headers","then","resp","json","data","removeCourse","removeCourseFromAllCourse","currentEnrollment","map","enrollment","student","removeClickedCourse","subject","name","pathname","courseProps","position","mapStateToProps","state","mapDispatchToProps","dispatch","type","payload"],"mappings":"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","sourcesContent":["import React, {useState} from 'react'\nimport {Link} from 'react-router-dom'\nimport {connect} from 'react-redux'\nimport {Confirm} from 'semantic-ui-react'\n\n\nfunction CourseCard(props) {\n    // console.log(props.course.id)\n    const token = localStorage.getItem(\"token\")\n\n    const [open, setOpen] = useState(false)\n    const [openStudent, setOpenStudent] = useState(false)\n\n    function show(){\n        setOpen(true)\n    }\n    function handleConfirm(id){\n        handleOnClick()\n        setOpen(false)\n    }\n    function handleCancel(){\n        setOpen(false)\n    }\n\n    function studentShow(){\n        setOpenStudent(true)\n    }\n    function studentHandleConfirm(id){\n        handleStudentClick()\n        setOpenStudent(false)\n    }\n    function studentHandleCancel(){\n        setOpenStudent(false)\n    }\n\n    function handleOnClick(){\n        // console.log(props.course.id)\n        fetch(`https://lms-api-rails.herokuapp.com/api/v1/teachers/${props.currentUser.id}/courses/${props.course.id}`,{\n            method: \"DELETE\",\n            headers: {\n                \"Authorization\": `Bearer ${token}`\n            }\n        })\n        .then(resp => resp.json())\n        .then(data => {\n            // console.log(data) //returns json message of delete success\n            props.removeCourse(props.course.id)\n            props.removeCourseFromAllCourse(props.course.id)\n        })\n    }\n    function handleStudentClick(){\n        const token = localStorage.getItem(\"token\")\n        // console.log(props.course)\n        // console.log(props.currentUser)\n        let currentEnrollment;\n        fetch(`https://lms-api-rails.herokuapp.com/api/v1/students/${props.currentUser.id}/enrollments`,{\n            headers: {\n                \"Authorization\": `Bearer ${token}`\n           }\n        })\n        .then(resp => resp.json())\n        .then(data => {\n            // console.log(data)\n            data.map(enrollment => {\n                // debugger\n                if(enrollment.course.id === props.course.id && enrollment.student.id === props.currentUser.id){\n                    currentEnrollment = enrollment\n                    // debugger\n                }\n            })\n            removeClickedCourse(currentEnrollment.id)\n        })\n        // console.log(currentEnrollment)\n  \n    }\n\n    function removeClickedCourse(id){\n        const token = localStorage.getItem(\"token\")\n        fetch(`https://lms-api-rails.herokuapp.com/api/v1/students/${props.currentUser.id}/enrollments/${id}`,{\n            method: \"DELETE\",\n            headers: {\n                \"Authorization\": `Bearer ${token}`\n           }\n\n        })\n        .then(resp => resp.json())\n        .then(data => {\n            // console.log(data) //returns json message of delete success\n            props.removeCourse(props.course.id)\n        })\n    }\n    return (\n        <div className=\"column\">\n                <div className=\"ui segment course\">\n                    <p>{props.course.subject.name}</p>\n                    <Link to={{\n                        pathname: `/courses/${props.course.id}`,\n                        courseProps: props.course\n                        }}>\n                        <h1>{props.course.name}</h1>\n                    </Link>\n                    <br></br>\n                    {\n                        props.currentUser.position === 'teacher' ? \n                        <span data-tooltip=\"Delete Course\" data-position=\"bottom left\">\n                            <i onClick={() => show()} className=\"big red trash icon\"></i>\n                            <Confirm\n                                open={open}\n                                header='Removing this Course.'\n                                onCancel={() => handleCancel()}\n                                onConfirm={() => handleConfirm()}\n                                />\n                        </span>\n                         \n                         :\n                         <React.Fragment>\n                            <button onClick={()=> studentShow()} className=\"ui red button\">Drop Course</button>\n                            <Confirm\n                                    open={openStudent}\n                                    header='Removing this Course.'\n                                    onCancel={() => studentHandleCancel()}\n                                    onConfirm={() => studentHandleConfirm()}\n                                    />\n                        </React.Fragment>\n                    }      \n                </div>\n        </div>\n    )\n}\n\nfunction mapStateToProps(state){\n    return {\n        currentUser: state.currentUser\n    }\n}\n\nfunction mapDispatchToProps(dispatch){\n    return{\n        removeCourse: (id) => {\n            dispatch({type: \"REMOVE_COURSE\", payload: id})\n        },\n        removeCourseFromAllCourse: (id) => {\n            dispatch({type:\"REMOVE_COURSE_FROM_ALL_COURSES\", payload:id})\n        }\n    }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(CourseCard)\n"]},"metadata":{},"sourceType":"module"}